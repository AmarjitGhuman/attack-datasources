- tactic:
    - TA0002
  technique: T1204
  sub_technique: T1204.002
  description: User Execution - Malicious File
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Windows registry
      data_components:
        - component: Windows registry key modification
          relationships:
            - source_data_element: process
              relationship: modified
              target_data_element: windows registry key value
- tactic:
    - TA0005
  technique: T1222
  sub_technique: T1222.001
  description: File and Directory Permissions Modification - Windows File and Directory Permissions Modification
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/defense_evasion/empire_dcsync_acl.tar.gz
  data_sources:
    - data_source: Windows active directory
      data_components:
        - component: active directory service access
          relationships:
            - source_data_element: user
              relationship: accessed
              target_data_element: ad object
        - component: active directory service modification
          relationships:
            - source_data_element: user
              relationship: modified
              target_data_element: ad object
- tactic:
    - TA0005
  technique: T1036
  sub_technique: T1036.002
  description: Masquerading - Right-to-Left Override
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
- tactic:
    - TA0005
  technique: T1036
  sub_technique: T1036.005
  description: Masquerading - Match Legitimate Name or Location
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Module
      data_components:
        - component: module load
          relationships:
            - source_data_element: process
              relationship: loaded
              target_data_element: executable
- tactic:
    - TA0011
  technique: T1571
  sub_technique: None
  description: Non-Standard Port
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
        - component: process network connection
          relationships:
            - source_data_element: process
              relationship: connected to
              target_data_element: port
- tactic:
    - TA0005
  technique: T1055
  sub_technique: T1055.001
  description: Process Injection - Dynamic-link Library Injection
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/defense_evasion/empire_dll_injection.tar.gz
  data_sources:
    - data_source: Process
      data_components:
        - component: process modification
          relationships:
            - source_data_element: process
              relationship: wrote to
              target_data_element: process
    - data_source: Module
      data_components:
        - component: module load
          relationships:
            - source_data_element: process
              relationship: loaded
              target_data_element: dll
    - data_source: File
      data_components:
        - component: file creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: file
- tactic:
    - TA0011
  technique: T1573
  sub_technique: T1573.001
  description: Encrypted Channel - Symmetric Cryptography
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Module
      data_components:
        - component: module load
          relationships:
            - source_data_element: process
              relationship: loaded
              target_data_element: dll
- tactic:
    - TA0002
  technique: T1059
  sub_technique: T1059.003
  description: Command and Scripting Interpreter - Windows Command Shell
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
- tactic:
    - TA0002
  technique: T1059
  sub_technique: T1059.001
  description: Command and Scripting Interpreter - PowerShell
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/execution/empire_launcher_vbs.zip
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/execution/empire_invoke_psremoting.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/execution/empire_invoke_psremoting.tar.gz
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
        - component: process network connection
          relationships:
            - source_data_element: process
              relationship: connected to
              target_data_element: port
    - data_source: Named pipe
      data_components:
        - component: named pipe creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: pipe
    - data_source: Module
      data_components:
        - component: module load
          relationships:
            - source_data_element: process
              relationship: loaded
              target_data_element: dll
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: user
              relationship: started
              target_data_element: application host
        - component: powershell context
          relationships:
            - source_data_element: application host
              relationship: started
              target_data_element:
            - source_data_element: application domain
              relationship: started
              target_data_element:
- tactic:
    - TA0007
  technique: T1083
  sub_technique: None
  description: File and Directory Discovery
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0009
  technique: T1119
  sub_technique: None
  description: Automated Collection
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0009
  technique: T1560
  sub_technique: T1560.001
  description: Archive Collected Data - Archive via Utility
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
- tactic:
    - TA0009
  technique: T1560
  sub_technique: T1560.002
  description: Archive Collected Data - Archive via Library
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: File
      data_components:
        - component: file creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: file
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0009
  technique: T1074
  sub_technique: T1074.001
  description: Data Staged - Local Data Staging
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
    - data_source: File
      data_components:
        - component: file creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: file
- tactic:
    - TA0011
  technique: T1105
  sub_technique: None
  description: Ingress Tool Transfer
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: File
      data_components:
        - component: file creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: file
        - component: file access
          relationships:
            - source_data_element: user
              relationship: accessed
              target_data_element: file
- tactic:
    - TA0005
  technique: T1027
  sub_technique: T1027.003
  description: Obfuscated Files or Information - Steganography
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0002
    - TA0008
  technique: T1047
  sub_technique: None
  description: Windows Management Instrumentation
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/execution/empire_invoke_wmi.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/execution/empire_wmic_add_user.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/execution/empire_invoke_wmi_debugger.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/defense_evasion/empire_psinject.tar.gz
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
            - source_data_element: user
              relationship: created
              target_data_element: process
    - data_source: Module
      data_components:
        - component: module load
          relationships:
            - source_data_element: process
              relationship: loaded
              target_data_element: dll
    - data_source: Authentication log
      data_components:
        - component: authentication success
          relationships:
            - source_data_element: user
              relationship: authenticated
              target_data_element: host
- tactic:
    - TA0003
    - TA0004
    - TA0008
  technique: T1546
  sub_technique: T1546.003
  description: Event Triggered Execution - Windows Management Instrumentation Event Subscription
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/persistence/empire_elevated_wmi.tar.gz
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
        - component: process network connection
          relationships:
            - source_data_element: process
              relationship: connected to
              target_data_element: ip
    - data_source: Module
      data_components:
        - component: module load
          relationships:
            - source_data_element: process
              relationship: loaded
              target_data_element: dll
    - data_source: Authentication log
      data_components:
        - component: authentication success
          relationships:
            - source_data_element: user
              relationship: authenticated
              target_data_element: host
    - data_source: WMI object
      data_components:
        - component: wmi object creation
          relationships:
            - source_data_element: user
              relationship: created
              target_data_element: wmi filter
            - source_data_element: user
              relationship: created
              target_data_element: wmi consumer
            - source_data_element: user
              relationship: created
              target_data_element: wmi subscription
        - component: wmi object context
          relationships:
            - source_data_element: wmi subscription
              relationship: created
              target_data_element:
- tactic:
    - TA0004
  technique: T1546
  sub_technique: T1546.015
  description: Event Triggered Execution - Component Object Model Hijacking
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Windows registry
      data_components:
        - component: Windows registry key modification
          relationships:
            - source_data_element: process
              relationship: modified
              target_data_element: windows registry key value
- tactic:
    - TA0003
  technique: T1547
  sub_technique: T1547.001
  description: Boot or Logon Autostart Execution - Registry Run Keys / Startup Folder
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: File
      data_components:
        - component: file creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: file
- tactic:
    - TA0004
  technique: T1548
  sub_technique: T1548.002
  description: Abuse Elevation Control Mechanism - Bypass User Access Control
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
- tactic:
    - TA0005
  technique: T1112
  sub_technique: None
  description: Modify Registry
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/defense_evasion/empire_wdigest_downgrade.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/small_datasets/windows/defense_evasion/host/empire_extended_netntlm_downgrade.tar.gz
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Windows registry
      data_components:
        - component: windows registry key access
          relationships:
            - source_data_element: process
              relationship: requested access
              target_data_element: windows registry key
            - source_data_element: user
              relationship: requested access
              target_data_element: windows registry key
            - source_data_element: process
              relationship: accessed
              target_data_element: windows registry key
            - source_data_element: user
              relationship: accessed
              target_data_element: windows registry key
        - component: windows registry key deletion
          relationships:
            - source_data_element: process
              relationship: deleted
              target_data_element: windows registry key
        - component: windows registry key modification
          relationships:
            - source_data_element: process
              relationship: modified
              target_data_element: windows registry key value
- tactic:
    - TA0005
  technique: T1140
  sub_technique: None
  description: Deobfuscate/Decode Files or Information
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0007
  technique: T1057
  sub_technique: None
  description: Process Discovery
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0005
  technique: T1070
  sub_technique: T1070.004
  description: Indicator Removal on Host - File Deletion
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: File
      data_components:
        - component: file deletion
          relationships:
            - source_data_element: process
              relationship: deleted
              target_data_element: file
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Windows registry
      data_components:
        - component: windows registry key creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: windows registry key
        - component: windows registry key modification
          relationships:
            - source_data_element: process
              relationship: modified
              target_data_element: windows registry key
- tactic:
    - TA0007
  technique: T1033
  sub_technique: None
  description: System Owner/User Discovery
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0007
  technique: T1082
  sub_technique: None
  description: System Information Discovery
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0007
  technique: T1016
  sub_technique: None
  description: System Network Configuration Discovery
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0007
  technique: T1518
  sub_technique: T1518.001
  description: Software Discovery - Security Software Discovery
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0007
  technique: T1069
  sub_technique: T1069.001
  description: Permission Groups Discovery - Local Groups
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0007
  technique: T1069
  sub_technique: T1069.002
  description: Permission Groups Discovery - Domain Groups
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: File
      data_components:
        - component: file access
          relationships:
            - source_data_element: user
              relationship: requested access
              target_data_element: file
    - data_source: Authentication log
      data_components:
        - component: authentication success
          relationships:
            - source_data_element: user
              relationship: authenticated
              target_data_element: host
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0002
  technique: T1106
  sub_technique: None
  description: Native API
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Module
      data_components:
        - component: module load
          relationships:
            - source_data_element: process
              relationship: loaded
              target_data_element: dll
- tactic:
    - TA0003
  technique: T1543
  sub_technique: T1543.003
  description: Create or Modify System Process - Windows Service
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/lateral_movement/covenant_wmi_event_subscription.zip
  data_sources:
    - data_source: Service
      data_components:
        - component: service creation
          relationships:
            - source_data_element: user
              relationship: created
              target_data_element: service
    - data_source: Windows registry
      data_components:
        - component: windows registry key creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: windows registry key
            - source_data_element: process
              relationship: created
              target_data_element: windows registry key value
        - component: windows registry key modification
          relationships:
            - source_data_element: process
              relationship: modified
              target_data_element: windows registry key
            - source_data_element: process
              relationship: modified
              target_data_element: windows registry key value
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0006
  technique: T1552
  sub_technique: T1552.004
  description: Unsecured Credentials - Private Keys
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: File
      data_components:
        - component: file creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: file
- tactic:
    - TA0006
  technique: T1003
  sub_technique: T1003.001
  description: OS Credential Dumping - LSASS Memory
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/empire_mimikatz_logonpasswords.zip
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/remoteinteractive_taskmngr_lsass_dump.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/interactive_taskmngr_lsass_dump.tar.gz
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
            - source_data_element: user
              relationship: created
              target_data_element: process
        - component: process access
          relationships:
            - source_data_element: process
              relationship: accessed
              target_data_element: process
            - source_data_element: process
              relationship: requested access
              target_data_element: process
    - data_source: Module
      data_components:
        - component: module load
          relationships:
            - source_data_element: process
              relationship: loaded
              target_data_element: dll
    - data_source: File
      data_components:
        - component: file creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: file
    - data_source: Authentication log
      data_components:
        - component: authentication success
          relationships:
            - source_data_element: user
              relationship: authenticated
              target_data_element: host
- tactic:
    - TA0006
  technique: T1003
  sub_technique: T1003.002
  description: OS Credential Dumping - Security Account Manager
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/empire_mimikatz_lsadump_sam.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/empire_powerdump.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/empire_reg_sam.tar.gz
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
        - component: process modification
          relationships:
            - source_data_element: process
              relationship: wrote to
              target_data_element: process
    - data_source: Windows registry
      data_components:
        - component: windows registry access
          relationships:
            - source_data_element: process
              relationship: requested access
              target_data_element: windows registry key
            - source_data_element: user
              relationship: requested access
              target_data_element: windows registry key
- tactic:
    - TA0006
  technique: T1003
  sub_technique: T1003.004
  description: OS Credential Dumping - LSA Secrets
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/empire_mimikatz_export_master_key.tar.gz
  data_sources:
    - data_source: Windows active directory
      data_components:
        - component: active directory service access
          relationships:
            - source_data_element: user
              relationship: accessed
              target_data_element: ad object
    - data_source: Authentication log
      data_components:
        - component: authentication success
          relationships:
            - source_data_element: user
              relationship: authenticated
              target_data_element: host
    - data_source: File
      data_components:
        - component: file access
          relationships:
            - source_data_element: user
              relationship: accessed
              target_data_element: file
            - source_data_element: user
              relationship: requested access
              target_data_element: file
- tactic:
    - TA0006
  technique: T1003
  sub_technique: T1003.006
  description: OS Credential Dumping - DCSync
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/empire_dcsync.tar.gz
  data_sources:
    - data_source: Windows active directory
      data_components:
        - component: active directory service access
          relationships:
            - source_data_element: user
              relationship: accessed
              target_data_element: ad object
    - data_source: Authentication log
      data_components:
        - component: authentication success
          relationships:
            - source_data_element: user
              relationship: authenticated
              target_data_element: host
- tactic:
    - TA0009
  technique: T1123
  sub_technique: None
  description: Audio Capture
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/collection/msf_record_mic.zip
  data_sources:
    - data_source: Windows registry
      data_components:
        - component: windows registry key creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: windows registry key
        - component: windows registry key modification
          relationships:
            - source_data_element: process
              relationship: modified
              target_data_element: windows registry key
            - source_data_element: process
              relationship: modified
              target_data_element: windows registry key value
        - component: windows registry key access
          relationships:
            - source_data_element: process
              relationship: requested access
              target_data_element: windows registry key
            - source_data_element: user
              relationship: requested access
              target_data_element: windows registry key
            - source_data_element: process
              relationship: accessed
              target_data_element: windows registry key
            - source_data_element: user
              relationship: accessed
              target_data_element: windows registry key
- tactic:
    - TA0009
  technique: T1113
  sub_technique: None
  description: Screen Capture
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Module
      data_components:
        - component: module load
          relationships:
            - source_data_element: process
              relationship: loaded
              target_data_element: dll
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0009
  technique: T1115
  sub_technique: None
  description: Clipboard Data
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0010
  technique: T1048
  sub_technique: T1048.003
  description: Exfiltration Over Alternative Protocol - Exfiltration Over Unencrypted/Obfuscated Non-C2
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
    - data_source: Powershell log
      data_components:
        - component: powershell execution
          relationships:
            - source_data_element: process
              relationship: executed
              target_data_element: command
- tactic:
    - TA0007
  technique: T1012
  sub_technique: None
  description: Query Registry
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_acces/empire_mimikatz_lsadump_sam.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/empire_powerdump.tar.gz
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/credential_access/empire_reg_sam.tar.gz
  data_sources:
    - data_source: Windows registry
      data_components:
        - component: windows registry key access
          relationships:
            - source_data_element: process
              relationship: accessed
              target_data_element: windows registry key
            - source_data_element: process
              relationship: requested access
              target_data_element: windows registry key
            - source_data_element: user
              relationship: requested access
              target_data_element: windows registry key
- tactic:
    - TA0007
  technique: T1018
  sub_technique: None
  description: Remote System Discovery
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
        - component: process network connection
          relationships:
            - source_data_element: process
              relationship: connected to
              target_data_element: port
- tactic:
    - TA0008
  technique: T1078
  sub_technique: T1078.002
  description: Valid Accounts - Domain Accounts
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
  data_sources:
    - data_source: Authentication log
      data_components:
        - component: authentication success
          relationships:
            - source_data_element: user
              relationship: authenticated
              target_data_element: host
- tactic:
    - TA0002
    - TA0008
  technique: T1569
  sub_technique: T1569.002
  description: System Services - Service Execution
  test_data:
    - https://github.com/OTRF/mordor/raw/master/datasets/large/apt29/day1/apt29_evals_day1_manual.zip
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/lateral_movement/empire_invoke_psexec.zip
  data_sources:
    - data_source: Service
      data_components:
        - component: service creation
          relationships:
            - source_data_element: user
              relationship: created
              target_data_element: service
    - data_source: Process
      data_components:
        - component: process creation
          relationships:
            - source_data_element: process
              relationship: created
              target_data_element: process
- tactic:
    - TA0007
  technique: T1007
  sub_technique: Mone
  description: System Service Discovery
  test_data:
    - https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/discovery/empire_find_local_admin.tar.gz
  data_sources:
    - data_source: File
      data_components:
        - component: file access
          relationships:
            - source_data_element: user
              relationship: requested access
              target_data_element: file
    - data_source: Process
      data_components:
        - component: process network connection
          relationships:
            - source_data_element: process
              relationship: connected to
              target_data_element: port
            - source_data_element: process
              relationship: connected to
              target_data_element: ip
    - data_source: Authentication log
      data_components:
        - component: authentication success
          relationships:
            - source_data_element: user
              relationship: authenticated
              target_data_element: host
